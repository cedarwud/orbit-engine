# Stage 2: 軌道計算層配置 - Grade A 學術級標準
# 符合文檔要求的 v2.0 模組化架構配置

# 時間序列配置 (Stage 2 v3.0 軌道狀態傳播 - 動態軌道週期)
time_series:
  interval_seconds: 60                   # 60秒時間解析度 (平衡精度與效率)
  use_orbital_period: true               # 使用實際軌道週期而非固定時間窗口
  # 動態計算配置 - 基於實際TLE軌道週期
  dynamic_calculation: true              # 啟用基於實際TLE數據的動態計算
  min_positions: 30                      # 最小位置點數（30分鐘數據）
  coverage_cycles: 1.0                   # 完整軌道週期覆蓋倍數

# SGP4 軌道傳播配置
sgp4_propagation:
  method: "SGP4"                         # 使用標準SGP4算法
  output_coordinate_system: "TEME"       # TEME座標系統

# 軌道計算配置 (舊版兼容)
orbital_calculation:
  algorithm: "SGP4"                      # 使用標準SGP4算法

  # ✅ 動態計算：基於實際TLE軌道參數
  dynamic_time_points: true              # 啟用動態時間點計算
  time_interval_seconds: 30              # 30秒時間解析度
  coverage_cycles: 1.0                   # 完整軌道週期

  # Grade A 標準：禁止星座特定硬編碼設置，改用動態計算
  # 所有計算基於實際TLE軌道參數，確保學術級精度

  use_orbital_period: true               # 使用實際軌道週期替代固定預測窗口

  coordinate_system: "TEME"              # 初始座標系統
  precision_grade: "A"                   # 學術級精度要求

# 可見性篩選配置
visibility_filter:
  min_elevation_deg: 10.0                # 預設最小仰角門檻 (NTPU標準)
  max_distance_km: 4000.0                # 最大距離限制 (基於ITU-R LEO標準，覆蓋OneWeb 3900km理論最大距離)
  min_distance_km: 200.0                 # 最小距離限制 (避免多普勒過大)

  # Grade A 標準：禁止星座特定硬編碼，改用統一標準
  # 基於ITU-R建議和學術研究的通用仰角門檻
  # 不再使用星座特定硬編碼參數

  # 觀測者位置配置 (可配置，支持多站點部署)
  observer_location:
    # Grade A 標準：支持動態配置觀測站位置
    # 可通過環境變量或外部配置覆蓋以下預設值
    latitude: ${OBSERVER_LATITUDE:24.9441}      # 緯度 (度)
    longitude: ${OBSERVER_LONGITUDE:121.3714}   # 經度 (度)
    altitude_km: ${OBSERVER_ALTITUDE:0.035}     # 海拔高度 (km)
    name: ${OBSERVER_NAME:"Default_Observer"}   # 觀測站名稱
    # 示例配置：NTPU台北 (24.9441°N, 121.3714°E, 35m)

  # 地理邊界 (可選的額外篩選)
  geographic_bounds:
    min_latitude: -90.0
    max_latitude: 90.0
    min_longitude: -180.0
    max_longitude: 180.0

# 座標轉換配置
coordinate_conversion:
  precision_mode: "high"                 # 高精度模式
  reference_frame: "ITRF2014"           # 國際地球參考架構
  earth_model: "WGS84"                  # 世界大地測量系統
  time_standard: "UTC"                  # 協調世界時
  polar_motion: true                    # 啟用極移參數
  nutation: true                        # 啟用章動修正

# 鏈路可行性篩選配置 (Stage 2範圍內的系統約束篩選)
link_feasibility_filter:
  # 服務窗口要求 - 中等篩選，恢復可運作狀態
  min_service_window_minutes: 3.0        # 最小服務窗口時間 (3分鐘)
  min_feasibility_score: 0.4            # 最小可行性評分門檻 (中等門檻)

  # 品質分級門檻 (基於幾何約束的評分) - 標準嚴格門檻
  quality_thresholds:
    A:
      min_score: 0.8                     # A級：優秀鏈路品質
      min_service_time: 30               # 需要30分鐘以上服務時間
    B:
      min_score: 0.7                     # B級：良好鏈路品質
      min_service_time: 20               # 需要20分鐘以上服務時間
    C:
      min_score: 0.6                     # C級：可接受鏈路品質
      min_service_time: 15               # 需要15分鐘以上服務時間
    D:
      min_score: 0.5                     # D級：最低鏈路品質
      min_service_time: 10               # 需要10分鐘以上服務時間

# 性能配置
performance:
  timeout_thresholds:
    orbital_calculation: 600.0          # 軌道計算超時 (秒) - 基於9041顆衛星實際需求調整
    coordinate_conversion: 30.0         # 座標轉換超時 (秒)
    visibility_analysis: 60.0           # 可見性分析超時 (秒)
    trajectory_prediction: 45.0         # 軌道預測超時 (秒)

  memory_limits:
    max_satellites_batch: 10000         # 批次處理最大衛星數
    max_positions_cache: 1000000        # 位置緩存上限

  # 🚀 快速測試模式 (用於驗證流程)
  testing_mode:
    enabled: false                      # 禁用測試模式，使用全量9041顆衛星
    satellite_sample_size: 100          # 只處理100顆衛星進行快速測試
    sample_method: "random"             # 隨機取樣 (可選: first, random, distributed)
    preserve_constellation_ratio: true   # 保持星座比例 (Starlink/OneWeb)

# 驗證配置
validation:
  academic_standards:
    grade: "A"                          # 學術級等級
    position_accuracy_km: 1.0           # 位置精度要求 <1km
    time_accuracy_seconds: 1.0          # 時間精度要求 <1s
    angular_accuracy_degrees: 0.1       # 角度精度要求 <0.1°

  quality_checks:
    min_satellites_processed: 1         # 最少處理衛星數
    min_success_rate: 0.95              # 最低成功率 95%
    max_calculation_time: 600           # 最大計算時間 10分鐘 (基於大規模真實數據處理需求)

  prohibited_items:
    - "simplified_algorithms"           # 禁止簡化算法
    - "mock_data"                      # 禁止模擬數據
    - "hardcoded_values"               # 禁止硬編碼數值
    - "approximate_methods"            # 禁止近似方法

# 輸出配置
output:
  format: "standard"                    # 標準格式
  include_metadata: true                # 包含元數據
  include_statistics: true              # 包含統計信息
  include_validation: true              # 包含驗證結果
  compress_results: false               # 不壓縮結果 (保持可讀性)

# 日誌配置
logging:
  level: "INFO"                         # 日誌級別
  include_performance: true             # 包含性能指標
  include_validation: true              # 包含驗證信息
  academic_compliance_tracking: true    # 學術合規追蹤

# 版本與元數據
metadata:
  version: "2.0.0"
  architecture: "modular_v2"
  academic_grade: "A"
  compliance_standard: "SGP4_SDP4_ITU-R"
  author: "Orbit Engine System"
  description: "Grade A Academic Orbital Computing Layer"
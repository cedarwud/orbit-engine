# ğŸš€ Orbit Engine å¿«é€Ÿå•Ÿå‹•æŒ‡å—

**æ›´æ–°æ—¥æœŸ**: 2025-10-03  
**ç‰ˆæœ¬**: é›¶é…ç½®åŸ·è¡Œç‰ˆ

---

## ğŸ“‹ ç›®éŒ„
- [æœ€ç°¡å–®çš„åŸ·è¡Œæ–¹å¼](#æœ€ç°¡å–®çš„åŸ·è¡Œæ–¹å¼)
- [ä¸‰ç¨®åŸ·è¡Œæ–¹å¼](#ä¸‰ç¨®åŸ·è¡Œæ–¹å¼)
- [ç’°å¢ƒé…ç½®èªªæ˜](#ç’°å¢ƒé…ç½®èªªæ˜)
- [å¸¸è¦‹å•é¡Œ](#å¸¸è¦‹å•é¡Œ)

---

## ğŸ¯ æœ€ç°¡å–®çš„åŸ·è¡Œæ–¹å¼

### æ–¹å¼ä¸€ï¼šä¸€éµåŸ·è¡Œï¼ˆæ¨è–¦ï¼‰

```bash
cd /home/sat/orbit-engine

# åŸ·è¡Œå…¨éƒ¨å…­éšæ®µ
./run.sh

# åŸ·è¡Œå–®ä¸€éšæ®µ
./run.sh --stage 1          # åªåŸ·è¡Œéšæ®µ 1
./run.sh --stage 5          # åªåŸ·è¡Œéšæ®µ 5ï¼ˆä¿¡è™Ÿåˆ†æï¼‰

# åŸ·è¡Œéšæ®µç¯„åœ
./run.sh --stages 1-3       # åŸ·è¡Œéšæ®µ 1 åˆ° 3
./run.sh --stages 1,3,5     # åŸ·è¡Œéšæ®µ 1, 3, 5

# é¡¯ç¤ºå¹«åŠ©
./run.sh --help
```

**å°±é€™éº¼ç°¡å–®ï¼** è…³æœ¬æœƒè‡ªå‹•ï¼š
- âœ… å•Ÿå‹•è™›æ“¬ç’°å¢ƒ
- âœ… åŠ è¼‰ `.env` é…ç½®
- âœ… åŸ·è¡ŒæŒ‡å®šéšæ®µ
- âœ… é¡¯ç¤ºåŸ·è¡Œç‹€æ…‹

### æ–¹å¼äºŒï¼šæ‰‹å‹•åŸ·è¡Œ

```bash
cd /home/sat/orbit-engine
source venv/bin/activate

# åŸ·è¡Œå…¨éƒ¨éšæ®µ
python scripts/run_six_stages_with_validation.py

# åŸ·è¡Œå–®ä¸€éšæ®µ
python scripts/run_six_stages_with_validation.py --stage 1

# åŸ·è¡Œéšæ®µç¯„åœ
python scripts/run_six_stages_with_validation.py --stages 1-3
python scripts/run_six_stages_with_validation.py --stages 1,3,5
```

**ç„¡éœ€ exportï¼** è…³æœ¬æœƒè‡ªå‹•å¾ `.env` è®€å–é…ç½®ã€‚

### æ–¹å¼ä¸‰ï¼šDocker å®¹å™¨åŸ·è¡Œ

```bash
# æ–¹å¼ 3A: ä½¿ç”¨å¿«æ·è…³æœ¬ï¼ˆæ¨è–¦ï¼‰
./run-docker.sh                    # åŸ·è¡Œå…¨éƒ¨å…­éšæ®µ
./run-docker.sh --stage 5          # åªåŸ·è¡Œéšæ®µ 5
./run-docker.sh --stages 1-3       # åŸ·è¡Œéšæ®µ 1-3
./run-docker.sh --build            # é‡æ–°æ§‹å»ºå®¹å™¨
./run-docker.sh --shell            # é€²å…¥å®¹å™¨ shell

# æ–¹å¼ 3B: ä½¿ç”¨ Makefileï¼ˆæœ€ç°¡æ½”ï¼‰
make docker                        # åŸ·è¡Œå…¨éƒ¨å…­éšæ®µ
make docker-stage STAGE=5          # åªåŸ·è¡Œéšæ®µ 5
make docker-stages STAGES=1-3      # åŸ·è¡Œéšæ®µ 1-3
make docker-build                  # é‡æ–°æ§‹å»ºå®¹å™¨
make docker-shell                  # é€²å…¥å®¹å™¨ shell

# æ–¹å¼ 3C: åŸç”Ÿ Docker å‘½ä»¤
docker build -t orbit-engine .
docker run --rm -v $(pwd)/data:/orbit-engine/data orbit-engine
docker run --rm orbit-engine python scripts/run_six_stages_with_validation.py --stage 5
```

**å®¹å™¨ç‰¹æ€§**:
- âœ… è‡ªå‹•è®€å– `.env` é…ç½®ï¼ˆæœ¬åœ° `.env` æœƒè¦†è“‹å®¹å™¨å…§å»ºï¼‰
- âœ… æ•¸æ“šæŒä¹…åŒ–ï¼ˆ`data/` ç›®éŒ„æ›è¼‰ï¼‰
- âœ… ç’°å¢ƒéš”é›¢ï¼ˆä¸å½±éŸ¿ä¸»æ©Ÿï¼‰

---

## ğŸ”§ åŸ·è¡Œæ–¹å¼å®Œæ•´å°æ¯”

| æ–¹å¼ | å¿«æ·å‘½ä»¤ | åŸç”Ÿå‘½ä»¤ | å„ªé» | é©ç”¨å ´æ™¯ |
|------|---------|---------|------|---------|
| **æœ¬åœ°ä¸€éµ** | `./run.sh --stage 5` | - | å…¨è‡ªå‹•ï¼Œæœ€ç°¡å–® | æ—¥å¸¸é–‹ç™¼ |
| **æœ¬åœ°æ‰‹å‹•** | - | `source venv/bin/activate && python ...` | éˆæ´»æ§åˆ¶ | èª¿è©¦/é–‹ç™¼ |
| **å®¹å™¨è…³æœ¬** | `./run-docker.sh --stage 5` | - | è‡ªå‹•åŒ–å®¹å™¨åŸ·è¡Œ | å¿«é€Ÿé©—è­‰ |
| **Makefile** | `make docker-stage STAGE=5` | - | æœ€ç°¡æ½” | æ¨™æº–åŒ–æµç¨‹ |
| **åŸç”Ÿ Docker** | - | `docker run orbit-engine ...` | å®Œå…¨æ§åˆ¶ | ç”Ÿç”¢/CI/CD |

---

## ğŸ“Š éšæ®µé¸æ“‡èªªæ˜

### å…­éšæ®µåŠŸèƒ½æ¦‚è¦½

| éšæ®µ | åç¨± | åŠŸèƒ½ | è¼¸å‡º | åŸ·è¡Œæ™‚é–“ |
|------|------|------|------|---------|
| **1** | TLE åŠ è¼‰èˆ‡è»Œé“åˆå§‹åŒ– | è¼‰å…¥è¡›æ˜Ÿ TLE æ•¸æ“šï¼Œåˆå§‹åŒ– SGP4 | `stage1_orbital_data.json` | ~5ç§’ |
| **2** | è»Œé“å‚³æ’­è¨ˆç®— | 95åˆ†é˜æ™‚é–“åºåˆ—è»Œé“è¨ˆç®— | `stage2_propagation.json` | ~30ç§’ |
| **3** | åæ¨™è½‰æ› | TEME â†’ ECEF â†’ Geodetic | `stage3_coordinates.json` | ~15ç§’ |
| **4** | éˆè·¯å¯è¡Œæ€§åˆ†æ | å¯è¦‹æ€§ã€Pool å„ªåŒ–ã€æ›æ‰‹åˆ†æ | `stage4_link_analysis.json` | ~45ç§’ |
| **5** | ä¿¡è™Ÿè³ªé‡åˆ†æ | RSRP/RSRQ/SINRã€å¤§æ°£è¡°æ¸› | `stage5_signal.json` | ~20ç§’ |
| **6** | ç ”ç©¶å„ªåŒ– | æ›æ‰‹å„ªåŒ–ã€3GPP äº‹ä»¶åˆ†æ | `stage6_research.json` | ~10ç§’ |

### å¸¸ç”¨åŸ·è¡Œå ´æ™¯

**å ´æ™¯ 1: å®Œæ•´æµç¨‹**
```bash
./run.sh                    # åŸ·è¡Œå…¨éƒ¨å…­éšæ®µï¼ˆæ¸¬è©¦æ¨¡å¼ ~2åˆ†é˜ï¼‰
```

**å ´æ™¯ 2: åªé©—è­‰ ITU-Rpy å¤§æ°£è¡°æ¸›ï¼ˆStage 5ï¼‰**
```bash
./run.sh --stage 5          # åªåŸ·è¡Œä¿¡è™Ÿåˆ†æéšæ®µ
```

**å ´æ™¯ 3: è»Œé“è¨ˆç®—éƒ¨åˆ†ï¼ˆStage 1-2ï¼‰**
```bash
./run.sh --stages 1-2       # TLE åŠ è¼‰ + è»Œé“å‚³æ’­
```

**å ´æ™¯ 4: æ›æ‰‹åˆ†ææµç¨‹ï¼ˆStage 4,6ï¼‰**
```bash
./run.sh --stages 4,6       # éˆè·¯åˆ†æ + æ›æ‰‹å„ªåŒ–
```

**å ´æ™¯ 5: èª¿è©¦ç‰¹å®šéšæ®µ**
```bash
# åªåŸ·è¡Œ Stage 4ï¼ˆéœ€è¦ Stage 1-3 çš„è¼¸å‡ºå·²å­˜åœ¨ï¼‰
./run.sh --stage 4
```

---

## âš™ï¸ ç’°å¢ƒé…ç½®èªªæ˜

### .env æ–‡ä»¶é…ç½®

å°ˆæ¡ˆæ ¹ç›®éŒ„çš„ `.env` æ–‡ä»¶æœƒè¢«è‡ªå‹•è®€å–ï¼š

```bash
# /home/sat/orbit-engine/.env

# ğŸ§ª åŸ·è¡Œæ¨¡å¼
ORBIT_ENGINE_TEST_MODE=1        # 1=æ¸¬è©¦æ¨¡å¼(50è¡›æ˜Ÿ), 0=å®Œæ•´æ¨¡å¼(9039è¡›æ˜Ÿ)

# ğŸ“Š å–æ¨£æ¨¡å¼
ORBIT_ENGINE_SAMPLING_MODE=0    # 0=é—œé–‰, 1=å•Ÿç”¨

# ğŸ–¥ï¸ Python è¼¸å‡º
PYTHONUNBUFFERED=1              # 1=å³æ™‚è¼¸å‡ºæ—¥èªŒ
```

### ä¿®æ”¹é…ç½®

**è¦è™•ç†å…¨éƒ¨è¡›æ˜Ÿï¼Ÿ** ç·¨è¼¯ `.env`ï¼š

```bash
# æ”¹ç‚ºå®Œæ•´æ¨¡å¼
ORBIT_ENGINE_TEST_MODE=0
```

**è¦æ›´å¿«é€Ÿæ¸¬è©¦ï¼Ÿ** ä¿æŒé è¨­ï¼š

```bash
# æ¸¬è©¦æ¨¡å¼ï¼ˆç´„1-2åˆ†é˜ï¼‰
ORBIT_ENGINE_TEST_MODE=1
```

---

## ğŸ“Š åŸ·è¡Œæ¨¡å¼å°æ¯”

| æ¨¡å¼ | è¡›æ˜Ÿæ•¸é‡ | è™•ç†æ™‚é–“ | é…ç½® |
|------|---------|---------|------|
| **æ¸¬è©¦æ¨¡å¼** | 50 é¡† | ~1-2 åˆ†é˜ | `ORBIT_ENGINE_TEST_MODE=1` |
| **å®Œæ•´æ¨¡å¼** | 9039 é¡† | ~15-20 åˆ†é˜ | `ORBIT_ENGINE_TEST_MODE=0` |

---

## ğŸ” å¸¸è¦‹å•é¡Œ

### Q1: é‚„éœ€è¦æ‰‹å‹• export ç’°å¢ƒè®Šæ•¸å—ï¼Ÿ

**A:** âŒ ä¸éœ€è¦ï¼è…³æœ¬æœƒè‡ªå‹•å¾ `.env` è®€å–ã€‚

**èˆŠæ–¹å¼ï¼ˆä¸å†éœ€è¦ï¼‰**:
```bash
export ORBIT_ENGINE_TEST_MODE=1  # âŒ ä¸ç”¨äº†
export ORBIT_ENGINE_SAMPLING_MODE=0  # âŒ ä¸ç”¨äº†
```

**æ–°æ–¹å¼ï¼ˆè‡ªå‹•ï¼‰**:
```bash
./run.sh  # âœ… è‡ªå‹•è®€å– .env
```

### Q2: Docker å®¹å™¨å¦‚ä½•è®€å–é…ç½®ï¼Ÿ

**A:** å®¹å™¨å•Ÿå‹•æ™‚è‡ªå‹•è®€å–å…§å»ºçš„ `.env` æ–‡ä»¶ã€‚

å¦‚éœ€è¦†è“‹é…ç½®ï¼š
```bash
docker run -e ORBIT_ENGINE_TEST_MODE=0 orbit-engine  # å®Œæ•´æ¨¡å¼
```

### Q3: è™›æ“¬ç’°å¢ƒåœ¨å“ªè£¡ï¼Ÿ

**A:** å°ˆæ¡ˆæ ¹ç›®éŒ„çš„ `venv/`ï¼š

```bash
/home/sat/orbit-engine/
â”œâ”€â”€ venv/              # Python 3.12 è™›æ“¬ç’°å¢ƒ
â”œâ”€â”€ .env               # ç’°å¢ƒé…ç½®ï¼ˆè‡ªå‹•è®€å–ï¼‰
â”œâ”€â”€ run.sh             # ä¸€éµå•Ÿå‹•è…³æœ¬
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ run_six_stages_with_validation.py
â””â”€â”€ ...
```

### Q4: å¦‚ä½•é©—è­‰é…ç½®å·²åŠ è¼‰ï¼Ÿ

**A:** åŸ·è¡Œæ™‚æœƒé¡¯ç¤ºé…ç½®è³‡è¨Šï¼š

```
âœ… å·²è‡ªå‹•åŠ è¼‰ç’°å¢ƒé…ç½®: /home/sat/orbit-engine/.env
   ORBIT_ENGINE_TEST_MODE = 1
```

### Q5: å¦‚ä½•åˆ‡æ›æ¸¬è©¦/å®Œæ•´æ¨¡å¼ï¼Ÿ

**A:** ç·¨è¼¯ `.env` æ–‡ä»¶ï¼Œä¿®æ”¹ `ORBIT_ENGINE_TEST_MODE` å³å¯ï¼š

```bash
# æ¸¬è©¦æ¨¡å¼ï¼ˆ50è¡›æ˜Ÿï¼‰
vim .env  # æ”¹ç‚º ORBIT_ENGINE_TEST_MODE=1

# å®Œæ•´æ¨¡å¼ï¼ˆ9039è¡›æ˜Ÿï¼‰
vim .env  # æ”¹ç‚º ORBIT_ENGINE_TEST_MODE=0
```

---

## ğŸš€ å…¸å‹å·¥ä½œæµç¨‹

### é–‹ç™¼/æ¸¬è©¦

```bash
cd /home/sat/orbit-engine

# ç¢ºä¿ .env ç‚ºæ¸¬è©¦æ¨¡å¼
grep TEST_MODE .env
# æ‡‰é¡¯ç¤º: ORBIT_ENGINE_TEST_MODE=1

# ä¸€éµåŸ·è¡Œ
./run.sh
```

### å®Œæ•´è™•ç†

```bash
cd /home/sat/orbit-engine

# ä¿®æ”¹ç‚ºå®Œæ•´æ¨¡å¼
sed -i 's/TEST_MODE=1/TEST_MODE=0/' .env

# åŸ·è¡Œ
./run.sh

# æ¢å¾©æ¸¬è©¦æ¨¡å¼
sed -i 's/TEST_MODE=0/TEST_MODE=1/' .env
```

### CI/CD æµç¨‹

```bash
# å®¹å™¨æ§‹å»º
docker build -t orbit-engine .

# æ¸¬è©¦æ¨¡å¼ï¼ˆå¿«é€Ÿé©—è­‰ï¼‰
docker run -e ORBIT_ENGINE_TEST_MODE=1 orbit-engine

# å®Œæ•´æ¨¡å¼ï¼ˆæ­£å¼è™•ç†ï¼‰
docker run -e ORBIT_ENGINE_TEST_MODE=0 orbit-engine
```

---

## ğŸ“š ç›¸é—œæ–‡æª”

- [ITU-Rpy æ•´åˆå ±å‘Š](ITU_RPY_INTEGRATION_SUMMARY.md)
- [Stage 5 ä¿¡è™Ÿåˆ†æ](stages/stage5-signal-analysis.md)
- [Final éœ€æ±‚è¦æ ¼](final.md)

---

## âœ… æª¢æŸ¥æ¸…å–®

åŸ·è¡Œå‰ç¢ºèªï¼š

- [ ] è™›æ“¬ç’°å¢ƒå·²å»ºç«‹ï¼ˆ`venv/` å­˜åœ¨ï¼‰
- [ ] `.env` æ–‡ä»¶å·²é…ç½®
- [ ] ITU-Rpy å·²å®‰è£ï¼ˆ`venv/bin/python -c "import itur"`ï¼‰
- [ ] TLE æ•¸æ“šå·²æº–å‚™ï¼ˆ`data/tle_data/` æœ‰æ•¸æ“šï¼‰

**å…¨éƒ¨ OKï¼Ÿç›´æ¥åŸ·è¡Œ `./run.sh` å³å¯ï¼** ğŸš€

---

**æ›´æ–°æ—¥æœŸ**: 2025-10-03  
**ç¶­è­·è€…**: Orbit Engine Project

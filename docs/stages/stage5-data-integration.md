# ğŸ“Š éšæ®µäº”ï¼šæ•¸æ“šæ•´åˆå±¤

[ğŸ”„ è¿”å›æ–‡æª”ç¸½è¦½](../README.md) > éšæ®µäº”

## ğŸ“– éšæ®µæ¦‚è¿°

**ç›®æ¨™**ï¼šå°‡å„ªåŒ–æ±ºç­–çµæœè½‰æ›ç‚ºå¤šç¨®è¼¸å‡ºæ ¼å¼ï¼Œç‚ºå‰ç«¯å’ŒAPIæœå‹™æº–å‚™æ•¸æ“š
**è¼¸å…¥**ï¼šStage 4å„ªåŒ–æ±ºç­–å±¤è¨˜æ†¶é«”å‚³éçš„å„ªåŒ–æ± æ•¸æ“šå’Œæ±ºç­–çµæœ
**è¼¸å‡º**ï¼šå¤šæ ¼å¼æ•¸æ“šåŒ… + å‹•ç•«æ•¸æ“š â†’ è¨˜æ†¶é«”å‚³éè‡³éšæ®µå…­
**æ ¸å¿ƒå·¥ä½œ**ï¼š
1. æ™‚é–“åºåˆ—æ•¸æ“šè½‰æ›å’Œæ’å€¼è™•ç†
2. å‹•ç•«è»Œè·¡æ•¸æ“šå»ºæ§‹å’Œé—œéµå¹€ç”Ÿæˆ
3. åˆ†å±¤æ•¸æ“šçµæ§‹å’Œç´¢å¼•å»ºç«‹
4. å¤šæ ¼å¼è¼¸å‡ºï¼ˆJSONã€GeoJSONã€CSVç­‰ï¼‰

**å¯¦éš›è™•ç†**ï¼šç´„150-250é¡†å„ªåŒ–å¾Œè¡›æ˜Ÿçš„å¤šæ ¼å¼è½‰æ›
**è™•ç†æ™‚é–“**ï¼šç´„50-60ç§’ï¼ˆv2.0å„ªåŒ–ç‰ˆæœ¬ï¼‰

### ğŸ—ï¸ v2.0 æ¨¡çµ„åŒ–æ¶æ§‹

Stage 5 å°ˆæ³¨æ–¼æ•¸æ“šæ ¼å¼åŒ–å’Œå‰ç«¯æº–å‚™ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Stage 5: æ•¸æ“šæ•´åˆå±¤                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚Timeseries   â”‚  â”‚Animation    â”‚  â”‚Layer Data   â”‚       â”‚
â”‚  â”‚Converter    â”‚  â”‚Builder      â”‚  â”‚Generator    â”‚       â”‚
â”‚  â”‚             â”‚  â”‚             â”‚  â”‚             â”‚       â”‚
â”‚  â”‚ â€¢ æ™‚åºè½‰æ›   â”‚  â”‚ â€¢ è»Œè·¡å‹•ç•«   â”‚  â”‚ â€¢ åˆ†å±¤æ•¸æ“š   â”‚       â”‚
â”‚  â”‚ â€¢ æ’å€¼è™•ç†   â”‚  â”‚ â€¢ é—œéµå¹€ç”Ÿæˆ â”‚  â”‚ â€¢ éšå±¤çµ„ç¹”   â”‚       â”‚
â”‚  â”‚ â€¢ å£“ç¸®å„ªåŒ–   â”‚  â”‚ â€¢ å¹³æ»‘è™•ç†   â”‚  â”‚ â€¢ ç´¢å¼•å»ºç«‹   â”‚       â”‚
â”‚  â”‚ â€¢ æ ¼å¼æ¨™æº–   â”‚  â”‚ â€¢ æ•ˆæœæ•¸æ“š   â”‚  â”‚ â€¢ æŸ¥è©¢å„ªåŒ–   â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚           â”‚              â”‚               â”‚                â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                          â–¼                                â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚           â”‚     Format Converter Hub        â”‚            â”‚
â”‚           â”‚                                 â”‚            â”‚
â”‚           â”‚ â€¢ JSON/XML/CSVè½‰æ›              â”‚            â”‚
â”‚           â”‚ â€¢ GeoJSONåœ°ç†æ ¼å¼               â”‚            â”‚
â”‚           â”‚ â€¢ å£“ç¸®å’Œæ‰“åŒ…                     â”‚            â”‚
â”‚           â”‚ â€¢ ç‰ˆæœ¬æ§åˆ¶                       â”‚            â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                          â–¼                                â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚           â”‚  Stage5 Data Processor         â”‚            â”‚
â”‚           â”‚                                 â”‚            â”‚
â”‚           â”‚ â€¢ æ•¸æ“šæµå”èª¿                     â”‚            â”‚
â”‚           â”‚ â€¢ å“è³ªæª¢æŸ¥                       â”‚            â”‚
â”‚           â”‚ â€¢ æ€§èƒ½å„ªåŒ–                       â”‚            â”‚
â”‚           â”‚ â€¢ è¼¸å‡ºç®¡ç†                       â”‚            â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒåŸå‰‡
- **æ ¼å¼æ¨™æº–åŒ–**: æä¾›æ¨™æº–åŒ–çš„æ•¸æ“šè¼¸å‡ºæ ¼å¼
- **å¤šæ ¼å¼æ”¯æ´**: æ”¯æ´JSONã€æ™‚é–“åºåˆ—ã€å‹•ç•«ç­‰å¤šç¨®æ ¼å¼
- **æ€§èƒ½å„ªåŒ–**: é«˜æ•ˆçš„æ•¸æ“šè½‰æ›å’Œè™•ç†
- **å‰ç«¯å‹å¥½**: ç›´æ¥å¯ç”¨çš„å‰ç«¯æ•¸æ“šæ ¼å¼

## ğŸ“¦ æ¨¡çµ„è¨­è¨ˆ

### 1. Timeseries Converter (`timeseries_converter.py`)

#### åŠŸèƒ½è·è²¬
- å°‡è¡›æ˜Ÿæ± æ•¸æ“šè½‰æ›ç‚ºæ™‚é–“åºåˆ—æ ¼å¼
- æä¾›æ™‚é–“æ’å€¼å’Œé‡æ¡æ¨£åŠŸèƒ½
- ç”Ÿæˆæ™‚é–“çª—å£æ•¸æ“š
- å„ªåŒ–æ™‚åºæ•¸æ“šå­˜å„²

#### æ ¸å¿ƒæ–¹æ³•
```python
class TimeseriesConverter:
    def convert_to_timeseries(self, satellite_pool):
        """è½‰æ›ç‚ºæ™‚é–“åºåˆ—æ•¸æ“šé›†"""

    def generate_time_windows(self, timeseries, window_duration):
        """ç”Ÿæˆæ™‚é–“çª—å£æ•¸æ“š"""

    def interpolate_missing_data(self, timeseries):
        """æ’å€¼ç¼ºå¤±æ•¸æ“š"""

    def compress_timeseries(self, timeseries):
        """å£“ç¸®æ™‚é–“åºåˆ—æ•¸æ“š"""
```

### 2. Animation Builder (`animation_builder.py`)

#### åŠŸèƒ½è·è²¬
- ç”Ÿæˆè¡›æ˜Ÿè»Œè·¡å‹•ç•«æ•¸æ“š
- å‰µå»ºé—œéµå¹€å’Œè£œé–“æ•¸æ“š
- æä¾›å¹³æ»‘å‹•ç•«æ•ˆæœ
- å„ªåŒ–å‹•ç•«æ€§èƒ½

#### æ ¸å¿ƒæ–¹æ³•
```python
class AnimationBuilder:
    def build_satellite_animation(self, timeseries):
        """å»ºæ§‹è¡›æ˜Ÿå‹•ç•«æ•¸æ“š"""

    def generate_trajectory_keyframes(self, satellite_timeseries):
        """ç”Ÿæˆè»Œè·¡é—œéµå¹€"""

    def create_coverage_animation(self, satellite_pool):
        """å‰µå»ºè¦†è“‹ç¯„åœå‹•ç•«"""

    def optimize_animation_performance(self, animation):
        """å„ªåŒ–å‹•ç•«æ€§èƒ½"""
```

### 3. Layer Data Generator (`layer_data_generator.py`)

#### åŠŸèƒ½è·è²¬
- ç”Ÿæˆåˆ†å±¤æ•¸æ“šçµæ§‹
- å»ºç«‹æ•¸æ“šç´¢å¼•å’ŒæŸ¥è©¢å„ªåŒ–
- æä¾›éšå±¤å¼æ•¸æ“šçµ„ç¹”
- æ”¯æ´å¤šå°ºåº¦æ•¸æ“šè¨ªå•

#### æ ¸å¿ƒæ–¹æ³•
```python
class LayerDataGenerator:
    def generate_hierarchical_data(self, timeseries):
        """ç”Ÿæˆéšå±¤å¼æ•¸æ“šé›†"""

    def create_spatial_layers(self, satellite_data):
        """å‰µå»ºç©ºé–“åˆ†å±¤"""

    def create_temporal_layers(self, timeseries):
        """å‰µå»ºæ™‚é–“åˆ†å±¤"""

    def build_multi_scale_index(self, hierarchical_data):
        """å»ºç«‹å¤šå°ºåº¦ç´¢å¼•"""
```

### 4. Format Converter Hub (`format_converter_hub.py`)

#### åŠŸèƒ½è·è²¬
- çµ±ä¸€æ ¼å¼è½‰æ›ç®¡ç†
- æ”¯æ´å¤šç¨®è¼¸å‡ºæ ¼å¼
- æä¾›ç‰ˆæœ¬æ§åˆ¶
- å„ªåŒ–è½‰æ›æ€§èƒ½

#### æ ¸å¿ƒæ–¹æ³•
```python
class FormatConverterHub:
    def convert_to_json(self, data, schema_version):
        """è½‰æ›ç‚ºJSONæ ¼å¼"""

    def convert_to_geojson(self, spatial_data):
        """è½‰æ›ç‚ºGeoJSONæ ¼å¼"""

    def convert_to_csv(self, tabular_data):
        """è½‰æ›ç‚ºCSVæ ¼å¼"""

    def package_for_api(self, data, api_version):
        """æ‰“åŒ…ç‚ºAPIæ ¼å¼"""
```

### 5. Stage5 Data Processor (`data_integration_processor.py`)

#### åŠŸèƒ½è·è²¬
- å”èª¿æ•¸æ“šè™•ç†æµç¨‹
- ç®¡ç†æ ¼å¼è½‰æ›
- å“è³ªæª¢æŸ¥å’Œé©—è­‰
- è¼¸å‡ºç®¡ç†å’Œå„ªåŒ–

## ğŸ”„ æ•¸æ“šæµç¨‹

### è¼¸å…¥è™•ç†
```python
# å¾Stage 4æ¥æ”¶æ•¸æ“š
stage4_output = {
    'optimal_pool': {...},        # å„ªåŒ–å¾Œçš„è¡›æ˜Ÿæ± 
    'handover_strategy': {...},   # æ›æ‰‹ç­–ç•¥
    'optimization_results': {...}, # å„ªåŒ–çµæœ
    'metadata': {...}             # è™•ç†å…ƒæ•¸æ“š
}
```

### è™•ç†æµç¨‹
1. **è¼¸å…¥æ•¸æ“šé©—è­‰**: ç¢ºèªå¾Stage 4æ¥æ”¶çš„æ•¸æ“šå®Œæ•´æ€§
2. **æ™‚é–“åºåˆ—è½‰æ›**: å°‡å„ªåŒ–æ± æ•¸æ“šè½‰æ›ç‚ºæ™‚é–“åºåˆ—
3. **å‹•ç•«æ•¸æ“šå»ºæ§‹**: ç”Ÿæˆè»Œè·¡å‹•ç•«å’Œé—œéµå¹€
4. **åˆ†å±¤æ•¸æ“šç”Ÿæˆ**: å‰µå»ºå¤šå°ºåº¦ç´¢å¼•å’Œéšå±¤çµæ§‹
5. **å¤šæ ¼å¼è¼¸å‡º**: è½‰æ›ç‚ºJSONã€GeoJSONã€CSVç­‰æ ¼å¼

### è¼¸å‡ºæ ¼å¼
```python
stage5_output = {
    'stage': 'stage5_data_integration',
    'timeseries_data': {
        'dataset_id': '...',
        'satellite_count': 150,
        'time_range': {...},
        'sampling_frequency': '10S',
        'satellite_timeseries': {...}
    },
    'animation_data': {
        'animation_id': '...',
        'duration': 300,  # seconds
        'frame_rate': 30,
        'satellite_trajectories': {...},
        'coverage_animation': {...}
    },
    'hierarchical_data': {
        'spatial_layers': [...],
        'temporal_layers': [...],
        'quality_layers': [...],
        'multi_scale_index': {...}
    },
    'formatted_outputs': {
        'json': {...},
        'geojson': {...},
        'csv': {...},
        'api_package': {...}
    },
    'metadata': {
        'processing_time': '2025-09-21T04:09:00Z',
        'processed_satellites': 150,
        'output_formats': 4,
        'compression_ratio': 0.72
    }
}
```

## âš™ï¸ é…ç½®åƒæ•¸

### æ™‚é–“åºåˆ—é…ç½®
```yaml
timeseries:
  sampling_frequency: "10S"        # 10ç§’æ¡æ¨£é »ç‡
  interpolation_method: "cubic_spline"  # ä¸‰æ¬¡æ¨£æ¢æ’å€¼
  compression_enabled: true        # å•Ÿç”¨å£“ç¸®
  compression_level: 6             # å£“ç¸®ç­‰ç´š
```

### å‹•ç•«é…ç½®
```yaml
animation:
  frame_rate: 30                   # 30 FPS
  duration_seconds: 300            # 5åˆ†é˜å‹•ç•«
  keyframe_optimization: true      # é—œéµå¹€å„ªåŒ–
  effect_quality: "high"           # é«˜å“è³ªæ•ˆæœ
```

### åˆ†å±¤é…ç½®
```yaml
layers:
  spatial_resolution_levels: 5     # 5ç´šç©ºé–“è§£æåº¦
  temporal_granularity: ["1MIN", "10MIN", "1HOUR"]
  quality_tiers: ["high", "medium", "low"]
  enable_spatial_indexing: true    # å•Ÿç”¨ç©ºé–“ç´¢å¼•
```

## ğŸ¯ æ€§èƒ½æŒ‡æ¨™

### è™•ç†æ•ˆèƒ½
- **è¼¸å…¥æ•¸æ“š**: ç´„150-250é¡†å„ªåŒ–å¾Œè¡›æ˜Ÿ
- **è¨ˆç®—æ™‚é–“**: 50-60ç§’
- **è¨˜æ†¶é«”ä½¿ç”¨**: <1GB
- **è¼¸å‡ºæ•¸æ“š**: å¤šæ ¼å¼æ•¸æ“šåŒ…

### è½‰æ›æ•ˆç‡
- **å£“ç¸®æ¯”**: >70%
- **æ ¼å¼è½‰æ›**: ä¸¦è¡Œè™•ç†
- **æ•¸æ“šæŸ¥è©¢**: <10mséŸ¿æ‡‰
- **å‹•ç•«å¹€ç‡**: 30 FPSç©©å®š

## ğŸ” é©—è­‰æ¨™æº–

### è¼¸å…¥é©—è­‰
- å„ªåŒ–æ± æ•¸æ“šå®Œæ•´æ€§
- æ±ºç­–çµæœæœ‰æ•ˆæ€§
- è¡›æ˜Ÿæ•¸é‡åˆç†æ€§

### è½‰æ›é©—è­‰
- æ™‚é–“åºåˆ—æ’å€¼ç²¾åº¦
- å‹•ç•«é—œéµå¹€æº–ç¢ºæ€§
- åˆ†å±¤ç´¢å¼•æ­£ç¢ºæ€§

### è¼¸å‡ºé©—è­‰
- å¤šæ ¼å¼æ•¸æ“šä¸€è‡´æ€§
- å£“ç¸®å“è³ªä¿è­‰
- APIæ ¼å¼æ¨™æº–åˆè¦

---
**ä¸‹ä¸€è™•ç†å™¨**: [æŒä¹…åŒ–èˆ‡APIå±¤](./stage6-persistence-api.md)
**ç›¸é—œæ–‡æª”**: [v2.0é‡æ§‹è¨ˆåŠƒ](../refactoring_plan_v2/stage5_data_processing.md)
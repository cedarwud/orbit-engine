[tool:pytest]
# pytest 配置 - TDD/BDD 架構重構
minversion = 7.4
addopts = 
    -ra -q 
    --strict-markers
    --strict-config
    --cov=src
    --cov-report=html:htmlcov
    --cov-report=term-missing
    --cov-report=xml
    --cov-fail-under=90
    --html=tests/reports/report.html
    --self-contained-html
    --json-report
    --json-report-file=tests/reports/report.json

testpaths = tests

# 測試標記定義
markers =
    unit: Unit tests (單元測試)
    integration: Integration tests (整合測試)
    bdd: BDD scenario tests (BDD場景測試)
    performance: Performance benchmark tests (性能基準測試)  
    compliance: Academic compliance tests (學術合規測試)
    slow: Tests that take > 10 seconds (慢速測試)
    sgp4: SGP4 orbital calculation tests (SGP4軌道計算測試)
    signal: Signal quality calculation tests (信號品質計算測試)
    visibility: Satellite visibility tests (衛星可見性測試)
    real_data: Tests using real TLE/signal data (真實數據測試)
    benchmark: Benchmark performance tests (性能基準測試)
    
# 測試檔案匹配規則
python_files = test_*.py *_test.py
python_classes = Test*
python_functions = test_*

# 過濾警告
filterwarnings =
    ignore::UserWarning
    ignore::DeprecationWarning:skyfield.*
    ignore::PendingDeprecationWarning
    
# 測試超時設定 (防止無限迴圈)
timeout = 300